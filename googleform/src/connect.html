<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Connect with SendGrid</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <h2 class="my-4">Connect with Twitter</h2>
        <input id="client_id" maxlength="73">
        <button class="btn btn-primary" id="buttonDiv" disabled="disabled" onClick="auth(this, event)">Connect</button>

    </div>

</body>
<script>
    let submitBtn = document.querySelector('#client_id');
    let button = document.querySelector('#buttonDiv');
    let validate = {
        akv: false,
        set apiKeyValid(b) {
            this.akv = b;
            this.check();
        },
        check: function () {
            if (this.akv) {
                button.removeAttribute('disabled');
            } else {
                button.setAttribute('disabled', 'disabled');
            }
        }
    }

    submitBtn.addEventListener('input', function () {
        let key = this.value;
        if (key.length >= 72) {
            validate.apiKeyValid = true;
            auth(key)
        } else {
            validate.apiKeyValid = false;
        }
    });
    function auth(key) {
        google.accounts.id.initialize({
            client_id: key,
            callback: handleCredentialResponse,
            context: "use",

        });
        google.accounts.id.renderButton(
            document.getElementById("buttonDiv"),
            { theme: "outline", size: "large", type: 'icon' }  // customization attributes
        );
        google.accounts.id.prompt()


    }
    function handleCredentialResponse(e) {
        console.log(e)
    }
</script>

</html>
